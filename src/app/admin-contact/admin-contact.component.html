<div class="admin-contact">

    <!-- ===================== Kontaktformular ===================== -->
    <h2>Neuen Kontakt erstellen</h2>
    <form (ngSubmit)="saveNewContact()" #contactForm="ngForm" class="contact-form">
      <input type="text" placeholder="Name" [(ngModel)]="newContact.name" name="name" required>
      <input type="text" placeholder="Telefon" [(ngModel)]="newContact.phone" name="phone">
      <input type="text" placeholder="Adresse" [(ngModel)]="newContact.address" name="address">
      <input type="email" placeholder="E-Mail" [(ngModel)]="newContact.email" name="email" required>

      <!-- Bildbereich -->
      <div class="image-upload">
        <label>Kontaktbild:</label>
        <input type="file" (change)="onImageSelected($event)">
        <button type="button" (click)="toggle('camera')">üì∑ Kamera</button>
        <button type="button" (click)="toggle('cropper')" [disabled]="!newContact.photo">‚úÇÔ∏è Zuschneiden</button>
        @if (newContact.photo) {
          <img [src]="newContact.photo" alt="Vorschau" width="80" height="80">
        }
      </div>

      <button type="submit" [disabled]="!contactForm.form.valid">Kontakt speichern</button>
    </form>

    <!-- ===================== Kartenformular ===================== -->
    <button (click)="showNewCard = !showNewCard">
      {{ showNewCard ? 'Karte verbergen' : 'Neue Karte hinzuf√ºgen' }}
    </button>

    @if (showNewCard) {
      <div>
        <h3>Karte hinzuf√ºgen</h3>
        <form (ngSubmit)="saveNewCard()" #cardForm="ngForm" class="card-form">
          <input type="text" placeholder="Titel" [(ngModel)]="newCard.title" name="title" required>
          <textarea placeholder="Beschreibung" [(ngModel)]="newCard.description" name="description"></textarea>
          <input type="file" (change)="onCardImageSelected($event)">
          @if (newCard.image) {
            <img [src]="newCard.image" alt="Kartenbild" width="100">
          }
          <button type="submit" [disabled]="!cardForm.form.valid">Karte speichern</button>
        </form>
      </div>
    }

    <!-- ===================== Kontaktliste ===================== -->
    <h2>Kontakte</h2>
    <div class="contact-list">
      @for (contact of contacts; track contact.id) {
        <div class="contact-card" (click)="selectContact(contact)"
             [class.selected]="selectedContact?.id === contact.id">
          <div class="contact-info">
            <div><strong>{{ contact.name }}</strong></div>
            <div>{{ contact.phone || '-' }}</div>
            <div>{{ contact.address || '-' }}</div>
            <div>{{ contact.email }}</div>
          </div>
          @if (contact.photo) {
            <img [src]="contact.photo" alt="Foto" width="80" height="80">
          }
          <button (click)="confirmDeleteContact(contact)">üóëÔ∏è</button>
        </div>
      }
    </div>

    <!-- ===================== Kartenliste zum gew√§hlten Kontakt ===================== -->
    @if (selectedContact) {
      <h3>Karten von {{ selectedContact.name }}</h3>
      <div class="card-list">
        @for (card of cards; track card.id) {
          <div class="card-item">
            <h4>{{ card.title }}</h4>
            <p>{{ card.description }}</p>
            @if (card.image) {
              <img [src]="card.image" alt="Bild" width="100">
            }
            <button (click)="editCard(card)">Bearbeiten</button>
            <button (click)="confirmDeleteCard(card)">L√∂schen</button>
          </div>
        }
      </div>
    }

    <!-- ===================== Kamera & Cropper ===================== -->
    @if (showCamera) {
      <app-camera-functions (imageTaken)="onCameraImage($event)"></app-camera-functions>
    }

    @if (showCropper && imageToEdit) {
      <app-cropper-functions
        [imageSrc]="imageToEdit"
        [shape]="cropShape"
        (cropped)="onCropped($event)">
      </app-cropper-functions>
    }

  </div>
